---
pagination:
  data: reviews
  size: 1
  alias: review
permalink: "/reviews/{{ review.slug }}/"
layout: layouts/base.njk
reviewPage: true
---

<article class="review-page">
  <div class="review-page-tools">
    <button id="favorite-toggle-btn" type="button" class="favorite-pin-btn" aria-label="Add this review to favorites">
      <svg class="favorite-pin-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M6 3.5H18A0.5 0.5 0 0 1 18.5 4V20.3A0.5 0.5 0 0 1 17.74 20.73L12 17.2L6.26 20.73A0.5 0.5 0 0 1 5.5 20.3V4A0.5 0.5 0 0 1 6 3.5Z"></path>
      </svg>
    </button>
    <p id="favorite-status" class="interaction-status favorite-status-inline" aria-live="polite" role="status"></p>
  </div>

  <div class="review-hero">
    {% if review.poster_path %}
    <aside class="review-aside">
      <div class="review-poster">
        <img
          src="{{ review.poster_path }}"
          alt="Poster for {{ review.title }}"
          class="poster-image"
          onerror="this.onerror=null;this.src='{{ '/images/placeholders/poster.svg' | url }}';"
        />
      </div>
    </aside>
    {% endif %}

    <div class="review-main-intro">
      <div class="review-header">
        <div class="review-title-section">
          <h1 class="review-title">{{ review.title }}</h1>
          <p class="review-verdict-tagline">{{ review.why }}</p>
        </div>

        <div class="review-verdict-box verdict-{{ review.verdict | verdictClass }}">
          <div class="verdict-badge">{{ review.verdict }}</div>
          <div class="verdict-rating">{{ review.rating }}<span class="rating-max">/10</span></div>
        </div>
      </div>

      <div class="review-meta">
        <div class="meta-item">
          <span class="meta-label">Released</span>
          <span class="meta-value">{{ review.releaseYear }}</span>
        </div>

        <div class="meta-item">
          <span class="meta-label">{% if review.type === 'movie' %}Director{% else %}Creator{% endif %}</span>
          <span class="meta-value">{{ review.creator }}</span>
        </div>

        <div class="meta-item">
          <span class="meta-label">{{ 'Streaming On' if review.type === 'movie' else 'Platform' }}</span>
          <span class="meta-value">{{ review.platform | join(', ') }}</span>
        </div>

        <div class="meta-item">
          <span class="meta-label">{{ 'Runtime' if review.type === 'movie' else 'Time Investment' }}</span>
          <span class="meta-value">{{ review.timeInvestment }}</span>
        </div>

        <div class="meta-item">
          <span class="meta-label">Age Rating</span>
          <span class="meta-value">{{ review.ageRating or '13+' }}</span>
        </div>

        {% if review.genre %}
        <div class="meta-item">
          <span class="meta-label">Genre</span>
          <span class="meta-value">{{ review.genre | join(', ') }}</span>
        </div>
        {% endif %}

        {% if review.type === 'movie' and review.tmdb_rating %}
        <div class="meta-item">
          <span class="meta-label">TMDB Score</span>
          <span class="meta-value">{{ review.tmdb_rating | round(1) }}/10</span>
        </div>
        {% endif %}

        {% if review.type === 'game' and review.metacritic_score %}
        <div class="meta-item">
          <span class="meta-label">Metacritic Score</span>
          <span class="meta-value">{{ review.metacritic_score }}/100</span>
        </div>
        {% endif %}
      </div>

      {% if review.official_description %}
      <div class="official-description">
        <p class="description-intro">
          <em>{{ 'From TMDB:' if review.type === 'movie' else 'From RAWG:' }}</em>
        </p>
        <p>{{ review.official_description }}</p>
      </div>
      {% endif %}

      {% set trailerKind = 'gameplay trailer' if review.type === 'game' else 'official trailer' %}
      <section class="review-trailer-card" aria-label="Trailer" data-trailer-candidate-ids="{{ review.trailerCandidateIdsCsv }}">
        <div class="review-trailer-head">
          <h2>Watch Trailer</h2>
          <p>
            {% if review.trailerUrl %}
            Preview the {{ trailerKind }} for {{ review.title }}.
            {% else %}
            We could not auto-find a trailer link yet, but you can jump to search.
            {% endif %}
          </p>
        </div>

        {% if review.trailerEmbedUrl %}
        <div class="review-trailer-media">
          <iframe
            id="review-trailer-iframe"
            src="{{ review.trailerEmbedUrl }}"
            title="Trailer for {{ review.title }}"
            loading="lazy"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
        </div>
        {% elseif review.trailerVideoUrl %}
        <div class="review-trailer-media">
          <video controls preload="metadata" poster="{{ review.card_image or review.poster_path }}">
            <source src="{{ review.trailerVideoUrl }}">
            Your browser does not support the trailer video.
          </video>
        </div>
        {% else %}
        <div class="review-trailer-empty">
          <p>No embedded trailer is available yet for this title.</p>
        </div>
        {% endif %}

        <div class="review-trailer-actions">
          {% if review.trailerUrl %}
          <a id="open-trailer-link" href="{{ review.trailerUrl }}" class="btn-secondary" target="_blank" rel="noopener noreferrer">Open Trailer</a>
          {% endif %}
          <a href="{{ review.trailerSearchUrl }}" class="btn-secondary" target="_blank" rel="noopener noreferrer">Search on YouTube</a>
        </div>
        <p id="review-trailer-status" class="interaction-status review-trailer-status" aria-live="polite"></p>
      </section>
    </div>
  </div>

  <div class="review-interactions" data-review-slug="{{ review.slug }}" data-review-title="{{ review.title }}" data-review-type="{{ review.type }}">
    <section class="review-actions-panel">
      <div class="audience-score-layout">
        <div class="audience-score-box">
          <p class="audience-score-label">Audience Score</p>
          <p class="audience-score-value"><strong id="community-rating-value">-</strong><span>/10</span></p>
          <p id="community-rating-count" class="audience-score-meta">(no user ratings yet)</p>
        </div>

        <div class="audience-rating-panel">
          <h3>Rate This Title</h3>
          <p class="audience-rating-hint">
            Rate this
            {% if review.type == 'movie' %}movie{% elseif review.type == 'game' %}game{% else %}show{% endif %}
            on a scale of 1 to 10.
          </p>
          <form id="user-rating-form" class="inline-form">
            <input id="user-rating-input" type="hidden" required>
            <div class="rating-picker" id="rating-picker" role="radiogroup" aria-label="Select your rating from 1 to 10">
              {% for score in [1,2,3,4,5,6,7,8,9,10] %}
              <button type="button" class="rating-choice" data-value="{{ score }}" role="radio" aria-checked="false">{{ score }}</button>
              {% endfor %}
            </div>
            <div class="inline-form-row">
              <button type="submit" class="btn-primary">Save</button>
            </div>
          </form>
          <p id="user-rating-status" class="interaction-status" aria-live="polite"></p>
        </div>
      </div>
    </section>

    <div class="review-mode-tabs" role="tablist" aria-label="Review and community tabs">
      <button type="button" id="tab-original" class="review-mode-tab is-active" role="tab" aria-selected="true" aria-controls="panel-original">Original Review</button>
      <button type="button" id="tab-community" class="review-mode-tab" role="tab" aria-selected="false" aria-controls="panel-community">Audience Takes</button>
    </div>

    <section id="panel-original" class="review-mode-panel is-active" role="tabpanel" aria-labelledby="tab-original">
      <div class="review-content">
        {% if review.hook %}
        <section class="review-section">
          <h2>Hook</h2>
          <p>{{ review.hook }}</p>
        </section>
        {% endif %}

        {% set gistText = review.playGist or review.quickGist %}
        {% if gistText %}
        <section class="review-section">
          <h2>{{ 'Play Gist' if review.playGist else 'Quick Gist' }}</h2>
          <p>{{ gistText }}</p>
        </section>
        {% endif %}

        {% set standoutItems = review.whatStandsOut or review.whatStoodOut or review.whatHitMe %}
        {% if standoutItems and standoutItems.length > 0 %}
        <section class="review-section">
          <h2>{{ 'What Stands Out' if review.whatStandsOut or review.whatStoodOut else 'What Hit Me' }}</h2>
          <ul class="review-bullet-list">
            {% for item in standoutItems %}
            <li><strong>{{ item.label }}:</strong> {{ item.text }}</li>
            {% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if review.ratingsSnapshot and review.ratingsSnapshot.length > 0 %}
        <section class="review-section">
          <h2>Ratings Snapshot</h2>
          <ul class="review-bullet-list">
            {% for item in review.ratingsSnapshot %}
            <li><strong>{{ item.label }}:</strong> {{ item.value }}</li>
            {% endfor %}
          </ul>
          {% if review.ratingsSummary %}
          <p>{{ review.ratingsSummary }}</p>
          {% endif %}
        </section>
        {% endif %}

        {% if review.criticsVoice %}
        <section class="review-section">
          <h2>Critics Voice</h2>
          <p>{{ review.criticsVoice }}</p>
        </section>
        {% endif %}

        {% if review.audienceVoice %}
        <section class="review-section">
          <h2>Audience Voice</h2>
          <p>{{ review.audienceVoice }}</p>
        </section>
        {% endif %}

        {% set reasonsList = review.whyYouShouldWatch or review.whyYouShouldPlay %}
        {% if reasonsList and reasonsList.length > 0 %}
        <section class="review-section">
          <h2>{{ 'Why You Should Play' if review.whyYouShouldPlay else 'Why You Should Watch' }}</h2>
          <ol class="review-number-list">
            {% for item in reasonsList %}
            <li>{{ item }}</li>
            {% endfor %}
          </ol>
        </section>
        {% endif %}

        {% if review.miniAnecdote %}
        <section class="review-section">
          <h2>Mini Anecdote</h2>
          <p>{{ review.miniAnecdote }}</p>
        </section>
        {% endif %}

        {% if review.practicalTips %}
        <section class="review-section">
          <h2>Practical Tips</h2>
          <p>{{ review.practicalTips }}</p>
        </section>
        {% endif %}

        {% if review.finalNudge %}
        <section class="review-section">
          <h2>Final Nudge</h2>
          <p>{{ review.finalNudge }}</p>
        </section>
        {% endif %}

        {% if review.content %}
        <section class="review-section">
          <p>{{ review.content }}</p>
        </section>
        {% endif %}
      </div>

      <div class="review-footer">
        <div class="verdict-final verdict-{{ review.verdict | verdictClass }}">
          <h3>Final Verdict</h3>
          <p>
            <strong class="verdict-action">{{ review.verdict }}</strong>
            {% if review.verdict === 'Must Watch' or review.verdict === 'Must Play' %}
              This is essential. Stop reading and go enjoy it.
            {% elseif review.verdict === 'Worth Your Time' %}
              If it matches your taste, it's worthwhile.
            {% elseif review.verdict === 'Average' %}
              Decent, but not a priority unless you're already curious.
            {% else %}
              Your time is better spent elsewhere.
            {% endif %}
          </p>
        </div>

        {% if review.similarTitles and review.similarTitles.length > 0 %}
        <div class="similar-titles">
          <h3>Similar Titles</h3>
          <ul>
            {% for title in review.similarTitles %}
            <li>{{ title }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>

      <section class="public-comments">
        <div class="section-head">
          <h2>Comments</h2>
          <p>Let us know what you think. Share your take, reaction, or quick thoughts below.</p>
        </div>
        <form id="review-comment-form" class="stack-form">
          <label for="review-comment-input">Add your comment</label>
          <textarea id="review-comment-input" rows="4" maxlength="1200" placeholder="Share your thoughts on this review..." required></textarea>
          <button type="submit" class="btn-primary">Post Comment</button>
          <p id="review-comment-status" class="interaction-status" aria-live="polite"></p>
        </form>
        <div id="review-comments-list" class="comment-list"></div>
      </section>
    </section>

    <section id="panel-community" class="review-mode-panel" role="tabpanel" aria-labelledby="tab-community" hidden>
      <section class="community-post-editor">
        <div class="section-head">
          <h2>Audience Take</h2>
          <p>One post per user per title. You can edit or delete your own post anytime.</p>
        </div>
        <form id="community-post-form" class="stack-form">
          <label for="community-post-input">Your community take</label>
          <textarea id="community-post-input" rows="7" maxlength="3000" placeholder="Share your experience, feelings, or your own mini review..." required></textarea>
          <div class="inline-actions">
            <button type="submit" class="btn-primary">Publish / Update</button>
            <button type="button" id="community-post-delete-btn" class="btn-secondary">Delete My Post</button>
          </div>
          <p id="community-post-status" class="interaction-status" aria-live="polite"></p>
        </form>
      </section>
      <section class="community-feed">
        <div class="section-head">
          <h2>Audience Feed</h2>
          <p>Public discussions from everyone who watched or played this title.</p>
        </div>
        <div id="community-posts-list" class="community-list"></div>
      </section>
    </section>
  </div>

  <div class="review-nav">
    <a href="{{ '/reviews/' | url }}" class="btn-secondary">Back to Reviews</a>
  </div>
</article>

